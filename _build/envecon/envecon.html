---
interact_link: content/envecon/envecon.ipynb
kernel_name: python3
has_widgets: false
title: |-
  Environmental Economics
prev_page:
  url: /topic-intros/envecon.html
  title: |-
    Environmental Economics
next_page:
  url: /topic-intros/Econometrics.html
  title: |-
    Econometrics and Data Science
comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---
<main class="jupyter-page">
<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<table style="width: 100%;">
    <tr style="background-color: transparent;"><td>
        <img src="https://d8a-88.github.io/econ-fa19/assets/images/blue_text.png" width="250px" style="margin-left: 0;" />
    </td><td>
        <p style="text-align: right; font-size: 12pt;"><strong>Economic Models</strong>, Fall 2019<br>
            Dr. Eric Van Dusen</p></td></tr>
</table>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Lab-11:-Environmental-Economics">Lab 11: Environmental Economics<a class="anchor-link" href="#Lab-11:-Environmental-Economics"> </a></h1>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this lab, we will be exploring a dataset from an electricity strategy game that looks at porfolio of different power plants, companies, and their outputs. We will integrating data science into environmental economics.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">datascience</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">Dropdown</span><span class="p">,</span> <span class="n">IntSlider</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">mpatches</span>
<span class="kn">from</span> <span class="nn">utils</span> <span class="k">import</span> <span class="o">*</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the cell below, we load in the ESG table and sort it by the total variable cost column, <code>Total_Var_Cost_USDperMWH</code>. The result is stored as <code>ESG_sorted</code>.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ESG</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s2">&quot;ESGPorfolios_forcsv.csv&quot;</span><span class="p">)</span>
<span class="n">ESG_sorted</span> <span class="o">=</span> <span class="n">ESG</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;Total_Var_Cost_USDperMWH&quot;</span><span class="p">)</span>
<span class="n">ESG_sorted</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that we have sorted our table by the <code>Total_Var_Cost_USDperMWH</code>," we want to see the distribution of <code>Capacity_MW</code> and Variable Cost for a particular group. For a given capacity, what is the variable cost, or cost of producing an additional unit of capacity?</p>
<p>From the ESG_sorted table above, we are grouping by the first column, Group, to look closer at a particular energy source.</p>
<p>Select a particular group in the dropdown below to see a barchart of Variable Cost vs. Capacity_MW.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">interact</span><span class="p">(</span><span class="k">lambda</span> <span class="n">selection</span><span class="p">:</span> <span class="n">plot_group</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span> <span class="n">ESG_sorted</span><span class="p">),</span> <span class="n">selection</span><span class="o">=</span><span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">ESG</span><span class="p">[</span><span class="s2">&quot;Group&quot;</span><span class="p">])));</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Suppose we are not concerned with one particular group, and we want to see the distribution of Variable Cost for Capacity_MW across all energy sources. Each color shows a unique group below.</p>
<p>How do Capacity and Variable Cost affect each other? In order to determine the market price of energy in our simulation, demand is an important factor. We don't know exactly how much energy will be demanded in a given frame of time, however we can make predictions based off of estimates that we are given, and use those predictions to calculate the profitability of our plants.</p>
<p>We calculate the maximum variable cost companies can have in order to make profit based on an estimated demand. For now, we will make the assumption that plants are willing to sell at a price equal to their variable cost.</p>
<p>In the graph below, we added the vertical line for demand and horizontal line for variable cost cap. Since we have our power plants in order of lowest variable cost to highest variable cost, we can see that the companies to the left of the vertical demand line will produce energy while the companies to the right of the vertical demand line will choose not to.</p>
<p>Why? The market will purchase energy from the power plants that have the cheapest prices, and we have graphed the cumulative energy production of companies ordered by increasing variable cost of production.</p>
<p>Adjust the slider for demand and notice how the lines, price, and Capacity_MW are changing as a result.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">interact</span><span class="p">(</span><span class="k">lambda</span> <span class="n">demand</span><span class="p">:</span> <span class="n">all_groups_with_demand</span><span class="p">(</span><span class="n">demand</span><span class="p">,</span> <span class="n">ESG_sorted</span><span class="p">),</span> 
         <span class="n">demand</span><span class="o">=</span><span class="n">IntSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">23000</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1000</span><span class="p">));</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that we have seen how <code>Capacity_MV</code>, <code>Variable Cost</code>, and price change as demand changes, we want to be able to calculate profit generated by a given power plant.</p>
<p>Run the profit function and the interactive slider in the next two cells below to see how profit changes with demand for each power plant.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">profit</span><span class="p">(</span><span class="n">sorted_table</span><span class="p">,</span> <span class="n">price</span><span class="p">):</span>
    <span class="n">capacity_subset</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">sorted_table</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;Total_Var_Cost_USDperMWH&quot;</span><span class="p">,</span> <span class="n">are</span><span class="o">.</span><span class="n">below</span><span class="p">(</span><span class="n">price</span><span class="p">))[</span><span class="s2">&quot;Capacity_MW&quot;</span><span class="p">])</span>
    <span class="n">revenue</span> <span class="o">=</span> <span class="n">capacity_subset</span> <span class="o">*</span> <span class="n">price</span>
    <span class="n">cost</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sorted_table</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;Total_Var_Cost_USDperMWH&quot;</span><span class="p">,</span> <span class="n">are</span><span class="o">.</span><span class="n">below</span><span class="p">(</span><span class="n">price</span><span class="p">))[</span><span class="s2">&quot;Total_Var_Cost_USDperMWH&quot;</span><span class="p">])):</span>
        <span class="n">cost</span> <span class="o">+=</span> <span class="n">sorted_table</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;Total_Var_Cost_USDperMWH&quot;</span><span class="p">,</span> <span class="n">are</span><span class="o">.</span><span class="n">below</span><span class="p">(</span><span class="n">price</span><span class="p">))[</span><span class="s2">&quot;Total_Var_Cost_USDperMWH&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>\
        <span class="o">*</span> <span class="n">sorted_table</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;Total_Var_Cost_USDperMWH&quot;</span><span class="p">,</span> <span class="n">are</span><span class="o">.</span><span class="n">below</span><span class="p">(</span><span class="n">price</span><span class="p">))[</span><span class="s2">&quot;Capacity_MW&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">revenue</span> <span class="o">-</span> <span class="n">cost</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">interact</span><span class="p">(</span><span class="k">lambda</span> <span class="n">selection</span><span class="p">,</span> <span class="n">demand</span><span class="p">:</span> <span class="n">calc_profit</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span> <span class="n">demand</span><span class="p">,</span> <span class="n">ESG_sorted</span><span class="p">),</span> 
         <span class="n">selection</span><span class="o">=</span><span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">ESG_sorted</span><span class="p">[</span><span class="s2">&quot;Group&quot;</span><span class="p">])),</span> 
         <span class="n">demand</span><span class="o">=</span><span class="n">IntSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">23000</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1000</span><span class="p">));</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, we will give the electric plants the ability to set their own prices.</p>
<p>(Note: These bids actually comes from students in EEP 147 who played a simulation of the game)</p>
<p>Below, we load in the <code>bids</code> table with data on energy price bids for different plants and hours.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bids</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s2">&quot;S1_bids_0.csv&quot;</span><span class="p">)</span>
<span class="n">bids</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With a new bids table with data on energy price bids across different power plants and hours, we will now calculate and visualize the profit our power plants have generated in a given hour. We will also be able to calculate cumulative profits, emissions, and expected emissions.</p>
<p>We will need both of these tables, bids and ESG_sorted, to generate an analysis, so in the following cell we first join the tables based on the column Plant_ID.</p>
<p>In the visualization below, we see how price varies with Capacity for a given hour for all power plants from above as demand changes.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># make sorted joined table</span>
<span class="n">hour</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">sorted_joined_table</span> <span class="o">=</span> <span class="n">bids</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;PLANT_ID&quot;</span><span class="p">,</span> <span class="n">ESG_sorted</span><span class="p">,</span> <span class="s2">&quot;Plant_ID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;PRICE&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">hour</span><span class="p">))</span>
<span class="n">sorted_joined_table</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">interact</span><span class="p">(</span><span class="k">lambda</span> <span class="n">demand</span><span class="p">,</span> <span class="n">hour</span><span class="p">:</span> <span class="n">all_group_bids</span><span class="p">(</span><span class="n">demand</span><span class="p">,</span> <span class="n">hour</span><span class="p">,</span> <span class="n">sorted_joined_table</span><span class="p">),</span> 
         <span class="n">demand</span><span class="o">=</span><span class="n">IntSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">23000</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1000</span><span class="p">),</span> <span class="n">hour</span><span class="o">=</span><span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]));</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, let's examine a particular power plant for a given hour.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">interact</span><span class="p">(</span><span class="k">lambda</span> <span class="n">selection</span><span class="p">,</span> <span class="n">hour</span><span class="p">,</span> <span class="n">demand</span><span class="p">:</span> <span class="n">your_portfolio_plot</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span> <span class="n">hour</span><span class="p">,</span> <span class="n">demand</span><span class="p">,</span> <span class="n">sorted_joined_table</span><span class="p">),</span> 
         <span class="n">selection</span><span class="o">=</span><span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">ESG_sorted</span><span class="p">[</span><span class="s2">&quot;Group&quot;</span><span class="p">])),</span> <span class="n">hour</span><span class="o">=</span><span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> 
         <span class="n">demand</span><span class="o">=</span><span class="n">IntSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">23000</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1000</span><span class="p">));</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Given a power plant, hour, and demand, we have the market price. Below, we explore how we compare market price of energy for a given hour to the marginal costs of running the power plant plants that have a bid price that was below the market price.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">interact</span><span class="p">(</span><span class="k">lambda</span> <span class="n">selection</span><span class="p">,</span> <span class="n">hour</span><span class="p">,</span> <span class="n">demand</span><span class="p">:</span> <span class="n">marginal_cost_plot</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span> <span class="n">hour</span><span class="p">,</span> <span class="n">demand</span><span class="p">,</span> <span class="n">sorted_joined_table</span><span class="p">),</span> 
         <span class="n">selection</span><span class="o">=</span><span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">ESG_sorted</span><span class="p">[</span><span class="s2">&quot;Group&quot;</span><span class="p">])),</span> <span class="n">hour</span><span class="o">=</span><span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> 
         <span class="n">demand</span><span class="o">=</span><span class="n">IntSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">23000</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1000</span><span class="p">));</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">interact</span><span class="p">(</span><span class="k">lambda</span> <span class="n">selection</span><span class="p">,</span> <span class="n">hour</span><span class="p">,</span> <span class="n">demand</span><span class="p">:</span> <span class="n">calc_profit_by_hour</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span> <span class="n">hour</span><span class="p">,</span> <span class="n">demand</span><span class="p">,</span> <span class="n">sorted_joined_table</span><span class="p">),</span> 
         <span class="n">selection</span><span class="o">=</span><span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">ESG_sorted</span><span class="p">[</span><span class="s2">&quot;Group&quot;</span><span class="p">])),</span> <span class="n">hour</span><span class="o">=</span><span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> 
         <span class="n">demand</span><span class="o">=</span><span class="n">IntSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">23000</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1000</span><span class="p">));</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Below, we have the cumulative capacity for our plants when they were selling at cost.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ESG_sorted</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;Group&quot;</span><span class="p">,</span> <span class="s2">&quot;UNIT NAME&quot;</span><span class="p">,</span> <span class="s2">&quot;Capacity_MW&quot;</span><span class="p">,</span> <span class="s2">&quot;Total_Var_Cost_USDperMWH&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">with_column</span><span class="p">(</span>
    <span class="s2">&quot;Cumulative capacity&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">ESG_sorted</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;Capacity_MW&quot;</span><span class="p">)))</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;Cumulative capacity&quot;</span><span class="p">,</span> <span class="n">are</span><span class="o">.</span><span class="n">above</span><span class="p">(</span><span class="mi">12000</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we order this by the price in the first hour, the cumulative supply looks a bit different. As some producers price their electricity higher, for the same demand we have higher prices. Or for the same price, we have fewer sellers and lesser supply</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sorted_by_price</span> <span class="o">=</span> <span class="n">sorted_joined_table</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s2">&quot;PRICE1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;Group&quot;</span><span class="p">,</span> <span class="s2">&quot;UNIT NAME&quot;</span><span class="p">,</span> <span class="s2">&quot;Capacity_MW&quot;</span><span class="p">,</span> <span class="s2">&quot;Total_Var_Cost_USDperMWH&quot;</span><span class="p">,</span> <span class="s2">&quot;PRICE1&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sorted_by_price</span><span class="o">.</span><span class="n">with_column</span><span class="p">(</span><span class="s2">&quot;Cumulative capacity&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">sorted_by_price</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;Capacity_MW&quot;</span><span class="p">)))</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;Cumulative capacity&quot;</span><span class="p">,</span> <span class="n">are</span><span class="o">.</span><span class="n">above</span><span class="p">(</span><span class="mi">12000</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice the plants REDONDO 5&amp;6 and REDONDO 7&amp;8. When the demand was 15000 and sellers sold at cost, the market price was 41.94 and they supplied electricity.</p>
<p>But when plant owners set their own prices, REDONDO 5&amp;6 and REDONDO 7&amp;8 sold at 50 and 48 respectively. As the same 15000 level of demand, the market price rose to 45. REDONDO 5&amp;6 and REDONDO 7&amp;8 are not able to sell anymore.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It seems that if I bid at marginal cost, I still get full market price and get to sell. But if I bid higher, there may be a chance that I am priced out of the market.</p>
<p>It seems to reason that I will bid at cost then becuase I cannot make a profit if I cant sell. What if I told you that was not the case.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is what led to the <strong>California Electricity Crisis of 2001</strong>. Certain plant providers, like Enron, started turning off some of their power plants for 'maintainence' in peak hours. What that did was restrict supply. Done carefully, it can raise prices and boost profits by a lot.</p>
<p>You can read about it <a href="https://en.wikipedia.org/wiki/California_electricity_crisis">here</a></p>
<p>Let us understand the intuition behind it.</p>
<p>Consider a situation in which the plants REDONDO_7-8 and REDONDO_5-6 of Big Coal portfolio are turned off.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sorted_joined_table</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;PORTFOLIO&quot;</span><span class="p">,</span> <span class="s1">&#39;Big_Coal&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sorted_joined_table_no_coal</span> <span class="o">=</span> <span class="n">sorted_joined_table</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="s2">&quot;PLANT&quot;</span><span class="p">,</span> <span class="n">are</span><span class="o">.</span><span class="n">not_equal_to</span><span class="p">(</span><span class="s2">&quot;REDONDO_7-8&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="s2">&quot;PLANT&quot;</span><span class="p">,</span> <span class="n">are</span><span class="o">.</span><span class="n">not_equal_to</span><span class="p">(</span><span class="s2">&quot;REDONDO_5-6&quot;</span><span class="p">))</span>
<span class="n">sorted_joined_table_no_coal</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;PORTFOLIO&quot;</span><span class="p">,</span> <span class="s1">&#39;Big_Coal&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When the plants were present, this is what the market equllibrium looked like.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">interact</span><span class="p">(</span><span class="k">lambda</span> <span class="n">demand</span><span class="p">,</span> <span class="n">hour</span><span class="p">:</span> <span class="n">all_group_bids</span><span class="p">(</span><span class="n">demand</span><span class="p">,</span> <span class="n">hour</span><span class="p">,</span> <span class="n">sorted_joined_table</span><span class="p">),</span> 
         <span class="n">demand</span><span class="o">=</span><span class="n">IntSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">23000</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1000</span><span class="p">),</span> <span class="n">hour</span><span class="o">=</span><span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]));</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Without the two coal plants removed - note the missing bars around 15000 capcity - the market looks like this. The price has increased for the same demand).</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">interact</span><span class="p">(</span><span class="k">lambda</span> <span class="n">demand</span><span class="p">,</span> <span class="n">hour</span><span class="p">:</span> <span class="n">all_group_bids</span><span class="p">(</span><span class="n">demand</span><span class="p">,</span> <span class="n">hour</span><span class="p">,</span> <span class="n">sorted_joined_table_no_coal</span><span class="p">),</span> 
         <span class="n">demand</span><span class="o">=</span><span class="n">IntSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">23000</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1000</span><span class="p">),</span> <span class="n">hour</span><span class="o">=</span><span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]));</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is the old profit, when all plants were operating.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">interact</span><span class="p">(</span><span class="k">lambda</span> <span class="n">selection</span><span class="p">,</span> <span class="n">hour</span><span class="p">,</span> <span class="n">demand</span><span class="p">:</span> <span class="n">calc_profit_by_hour</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span> <span class="n">hour</span><span class="p">,</span> <span class="n">demand</span><span class="p">,</span> <span class="n">sorted_joined_table</span><span class="p">),</span> 
         <span class="n">selection</span><span class="o">=</span><span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;Big Coal&#39;</span><span class="p">,</span> <span class="s1">&#39;Bay Views&#39;</span><span class="p">,</span> <span class="s1">&#39;Beachfront&#39;</span><span class="p">,</span> <span class="s1">&#39;Big Gas&#39;</span><span class="p">,</span> <span class="s1">&#39;East Bay&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Fossil Light&#39;</span><span class="p">,</span> <span class="s1">&#39;Old Timers&#39;</span><span class="p">])),</span> <span class="n">hour</span><span class="o">=</span><span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> 
         <span class="n">demand</span><span class="o">=</span><span class="n">IntSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">23000</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1000</span><span class="p">));</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>By strategically turning off a plant with high variable cost, the portfolio provider can increase price to an extent that the extra profit generated by lower variable cost plants is much more than the profit lost on the switched off plant.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">interact</span><span class="p">(</span><span class="k">lambda</span> <span class="n">selection</span><span class="p">,</span> <span class="n">hour</span><span class="p">,</span> <span class="n">demand</span><span class="p">:</span> <span class="n">calc_profit_by_hour</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span> <span class="n">hour</span><span class="p">,</span> <span class="n">demand</span><span class="p">,</span> <span class="n">sorted_joined_table_no_coal</span><span class="p">),</span> 
         <span class="n">selection</span><span class="o">=</span><span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;Big Coal&#39;</span><span class="p">,</span> <span class="s1">&#39;Bay Views&#39;</span><span class="p">,</span> <span class="s1">&#39;Beachfront&#39;</span><span class="p">,</span> <span class="s1">&#39;Big Gas&#39;</span><span class="p">,</span> <span class="s1">&#39;East Bay&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Fossil Light&#39;</span><span class="p">,</span> <span class="s1">&#39;Old Timers&#39;</span><span class="p">])),</span> <span class="n">hour</span><span class="o">=</span><span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> 
         <span class="n">demand</span><span class="o">=</span><span class="n">IntSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">23000</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1000</span><span class="p">));</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

 


</main>
